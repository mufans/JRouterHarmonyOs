"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Strategies=void 0;const fs_extra_1=__importDefault(require("fs-extra")),hash_util_js_1=require("../../common/util/hash-util.js"),types_js_1=require("./types.js"),util_js_1=require("./util.js"),inputHandler=(e,t,{inputs:r})=>{const n=["number","string","boolean"],u=null!=t?t:"";n.includes(typeof u)||Array.isArray(u)&&u.every((e=>n.includes(typeof e)))?r.set(e,u):r.set(e,(0,hash_util_js_1.hash)(JSON.stringify(u)))},inputsHandler=(e,t,r)=>{if(t instanceof Map)for(const[n,u]of t)inputHandler(`${e}-${n}`,u,r);else util_js_1.incrementalDeclaratorLogger.debug(`Decorator @Inputs can only be used for 'Map', but get '${(0,util_js_1.getType)(t)}' from '${e}'.`)},inputFileHandler=(e,t,{inputFiles:r},n)=>{"string"==typeof t?""!==t&&fs_extra_1.default.existsSync(t)?r.addEntry(t,n):util_js_1.incrementalDeclaratorLogger.debug(`File: '${t}' from '${e}' is not exists, just ignore.`):util_js_1.incrementalDeclaratorLogger.debug(`Decorator @InputFile can only be used for 'String', but get '${(0,util_js_1.getType)(t)}' from '${e}'.`)},inputFilesHandler=(e,t,r,n)=>{Array.isArray(t)?t.forEach((t=>{inputFileHandler(e,t,r,n)})):util_js_1.incrementalDeclaratorLogger.debug(`Decorator @InputFiles can only be used for 'Array', but get '${(0,util_js_1.getType)(t)}' from '${e}'.`)},outputFileHandler=(e,t,{outputFiles:r},n)=>{"string"==typeof t?""!==t?r.addEntry(t,n):util_js_1.incrementalDeclaratorLogger.debug(`Decorator @OutputFile get empty string from '${e}', just ignore.`):util_js_1.incrementalDeclaratorLogger.debug(`Decorator @OutputFile can only be used for 'String', but get '${(0,util_js_1.getType)(t)}' from '${e}'.`)},outputFilesHandler=(e,t,r,n)=>{Array.isArray(t)?t.forEach((t=>{outputFileHandler(e,t,r,n)})):util_js_1.incrementalDeclaratorLogger.debug(`Decorator @OutputFiles can only be used for 'Array', but get '${(0,util_js_1.getType)(t)}' from '${e}'.`)};exports.Strategies={[types_js_1.IncrementalDecoratorType.Input]:inputHandler,[types_js_1.IncrementalDecoratorType.Inputs]:inputsHandler,[types_js_1.IncrementalDecoratorType.InputFile]:inputFileHandler,[types_js_1.IncrementalDecoratorType.InputFiles]:inputFilesHandler,[types_js_1.IncrementalDecoratorType.OutputFile]:outputFileHandler,[types_js_1.IncrementalDecoratorType.OutputFiles]:outputFilesHandler};